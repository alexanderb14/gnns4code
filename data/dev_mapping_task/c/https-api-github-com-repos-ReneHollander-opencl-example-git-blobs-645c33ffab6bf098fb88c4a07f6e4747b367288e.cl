void A(uint* a, const uint* b) {
  uint c, d, e, f;
  c = a[0];
  d = a[1];
  e = a[2];
  f = a[3];

  (c) += (((f)) ^ (((d)) & (((e)) ^ ((f))))) + ((b[(0)])) + (0xd76aa478);
  (c) = (((c) << (7)) | (((c)&0xffffffff) >> (32 - (7))));
  (c) += (d);
  (f) += (((e)) ^ (((c)) & (((d)) ^ ((e))))) + ((b[(1)])) + (0xe8c7b756);
  (f) = (((f) << (12)) | (((f)&0xffffffff) >> (32 - (12))));
  (f) += (c);
  (e) += (((d)) ^ (((f)) & (((c)) ^ ((d))))) + ((b[(2)])) + (0x242070db);
  (e) = (((e) << (17)) | (((e)&0xffffffff) >> (32 - (17))));
  (e) += (f);
  (d) += (((c)) ^ (((e)) & (((f)) ^ ((c))))) + ((b[(3)])) + (0xc1bdceee);
  (d) = (((d) << (22)) | (((d)&0xffffffff) >> (32 - (22))));
  (d) += (e);
  (c) += (((f)) ^ (((d)) & (((e)) ^ ((f))))) + ((b[(4)])) + (0xf57c0faf);
  (c) = (((c) << (7)) | (((c)&0xffffffff) >> (32 - (7))));
  (c) += (d);
  (f) += (((e)) ^ (((c)) & (((d)) ^ ((e))))) + ((b[(5)])) + (0x4787c62a);
  (f) = (((f) << (12)) | (((f)&0xffffffff) >> (32 - (12))));
  (f) += (c);
  (e) += (((d)) ^ (((f)) & (((c)) ^ ((d))))) + ((b[(6)])) + (0xa8304613);
  (e) = (((e) << (17)) | (((e)&0xffffffff) >> (32 - (17))));
  (e) += (f);
  (d) += (((c)) ^ (((e)) & (((f)) ^ ((c))))) + ((b[(7)])) + (0xfd469501);
  (d) = (((d) << (22)) | (((d)&0xffffffff) >> (32 - (22))));
  (d) += (e);
  (c) += (((f)) ^ (((d)) & (((e)) ^ ((f))))) + ((b[(8)])) + (0x698098d8);
  (c) = (((c) << (7)) | (((c)&0xffffffff) >> (32 - (7))));
  (c) += (d);
  (f) += (((e)) ^ (((c)) & (((d)) ^ ((e))))) + ((b[(9)])) + (0x8b44f7af);
  (f) = (((f) << (12)) | (((f)&0xffffffff) >> (32 - (12))));
  (f) += (c);
  (e) += (((d)) ^ (((f)) & (((c)) ^ ((d))))) + ((b[(10)])) + (0xffff5bb1);
  (e) = (((e) << (17)) | (((e)&0xffffffff) >> (32 - (17))));
  (e) += (f);
  (d) += (((c)) ^ (((e)) & (((f)) ^ ((c))))) + ((b[(11)])) + (0x895cd7be);
  (d) = (((d) << (22)) | (((d)&0xffffffff) >> (32 - (22))));
  (d) += (e);
  (c) += (((f)) ^ (((d)) & (((e)) ^ ((f))))) + ((b[(12)])) + (0x6b901122);
  (c) = (((c) << (7)) | (((c)&0xffffffff) >> (32 - (7))));
  (c) += (d);
  (f) += (((e)) ^ (((c)) & (((d)) ^ ((e))))) + ((b[(13)])) + (0xfd987193);
  (f) = (((f) << (12)) | (((f)&0xffffffff) >> (32 - (12))));
  (f) += (c);
  (e) += (((d)) ^ (((f)) & (((c)) ^ ((d))))) + ((b[(14)])) + (0xa679438e);
  (e) = (((e) << (17)) | (((e)&0xffffffff) >> (32 - (17))));
  (e) += (f);
  (d) += (((c)) ^ (((e)) & (((f)) ^ ((c))))) + ((b[(15)])) + (0x49b40821);
  (d) = (((d) << (22)) | (((d)&0xffffffff) >> (32 - (22))));
  (d) += (e);

  (c) += (((e)) ^ (((f)) & (((d)) ^ ((e))))) + ((b[(1)])) + (0xf61e2562);
  (c) = (((c) << (5)) | (((c)&0xffffffff) >> (32 - (5))));
  (c) += (d);
  (f) += (((d)) ^ (((e)) & (((c)) ^ ((d))))) + ((b[(6)])) + (0xc040b340);
  (f) = (((f) << (9)) | (((f)&0xffffffff) >> (32 - (9))));
  (f) += (c);
  (e) += (((c)) ^ (((d)) & (((f)) ^ ((c))))) + ((b[(11)])) + (0x265e5a51);
  (e) = (((e) << (14)) | (((e)&0xffffffff) >> (32 - (14))));
  (e) += (f);
  (d) += (((f)) ^ (((c)) & (((e)) ^ ((f))))) + ((b[(0)])) + (0xe9b6c7aa);
  (d) = (((d) << (20)) | (((d)&0xffffffff) >> (32 - (20))));
  (d) += (e);
  (c) += (((e)) ^ (((f)) & (((d)) ^ ((e))))) + ((b[(5)])) + (0xd62f105d);
  (c) = (((c) << (5)) | (((c)&0xffffffff) >> (32 - (5))));
  (c) += (d);
  (f) += (((d)) ^ (((e)) & (((c)) ^ ((d))))) + ((b[(10)])) + (0x02441453);
  (f) = (((f) << (9)) | (((f)&0xffffffff) >> (32 - (9))));
  (f) += (c);
  (e) += (((c)) ^ (((d)) & (((f)) ^ ((c))))) + ((b[(15)])) + (0xd8a1e681);
  (e) = (((e) << (14)) | (((e)&0xffffffff) >> (32 - (14))));
  (e) += (f);
  (d) += (((f)) ^ (((c)) & (((e)) ^ ((f))))) + ((b[(4)])) + (0xe7d3fbc8);
  (d) = (((d) << (20)) | (((d)&0xffffffff) >> (32 - (20))));
  (d) += (e);
  (c) += (((e)) ^ (((f)) & (((d)) ^ ((e))))) + ((b[(9)])) + (0x21e1cde6);
  (c) = (((c) << (5)) | (((c)&0xffffffff) >> (32 - (5))));
  (c) += (d);
  (f) += (((d)) ^ (((e)) & (((c)) ^ ((d))))) + ((b[(14)])) + (0xc33707d6);
  (f) = (((f) << (9)) | (((f)&0xffffffff) >> (32 - (9))));
  (f) += (c);
  (e) += (((c)) ^ (((d)) & (((f)) ^ ((c))))) + ((b[(3)])) + (0xf4d50d87);
  (e) = (((e) << (14)) | (((e)&0xffffffff) >> (32 - (14))));
  (e) += (f);
  (d) += (((f)) ^ (((c)) & (((e)) ^ ((f))))) + ((b[(8)])) + (0x455a14ed);
  (d) = (((d) << (20)) | (((d)&0xffffffff) >> (32 - (20))));
  (d) += (e);
  (c) += (((e)) ^ (((f)) & (((d)) ^ ((e))))) + ((b[(13)])) + (0xa9e3e905);
  (c) = (((c) << (5)) | (((c)&0xffffffff) >> (32 - (5))));
  (c) += (d);
  (f) += (((d)) ^ (((e)) & (((c)) ^ ((d))))) + ((b[(2)])) + (0xfcefa3f8);
  (f) = (((f) << (9)) | (((f)&0xffffffff) >> (32 - (9))));
  (f) += (c);
  (e) += (((c)) ^ (((d)) & (((f)) ^ ((c))))) + ((b[(7)])) + (0x676f02d9);
  (e) = (((e) << (14)) | (((e)&0xffffffff) >> (32 - (14))));
  (e) += (f);
  (d) += (((f)) ^ (((c)) & (((e)) ^ ((f))))) + ((b[(12)])) + (0x8d2a4c8a);
  (d) = (((d) << (20)) | (((d)&0xffffffff) >> (32 - (20))));
  (d) += (e);

  (c) += (((d)) ^ ((e)) ^ ((f))) + ((b[(5)])) + (0xfffa3942);
  (c) = (((c) << (4)) | (((c)&0xffffffff) >> (32 - (4))));
  (c) += (d);
  (f) += (((c)) ^ ((d)) ^ ((e))) + ((b[(8)])) + (0x8771f681);
  (f) = (((f) << (11)) | (((f)&0xffffffff) >> (32 - (11))));
  (f) += (c);
  (e) += (((f)) ^ ((c)) ^ ((d))) + ((b[(11)])) + (0x6d9d6122);
  (e) = (((e) << (16)) | (((e)&0xffffffff) >> (32 - (16))));
  (e) += (f);
  (d) += (((e)) ^ ((f)) ^ ((c))) + ((b[(14)])) + (0xfde5380c);
  (d) = (((d) << (23)) | (((d)&0xffffffff) >> (32 - (23))));
  (d) += (e);
  (c) += (((d)) ^ ((e)) ^ ((f))) + ((b[(1)])) + (0xa4beea44);
  (c) = (((c) << (4)) | (((c)&0xffffffff) >> (32 - (4))));
  (c) += (d);
  (f) += (((c)) ^ ((d)) ^ ((e))) + ((b[(4)])) + (0x4bdecfa9);
  (f) = (((f) << (11)) | (((f)&0xffffffff) >> (32 - (11))));
  (f) += (c);
  (e) += (((f)) ^ ((c)) ^ ((d))) + ((b[(7)])) + (0xf6bb4b60);
  (e) = (((e) << (16)) | (((e)&0xffffffff) >> (32 - (16))));
  (e) += (f);
  (d) += (((e)) ^ ((f)) ^ ((c))) + ((b[(10)])) + (0xbebfbc70);
  (d) = (((d) << (23)) | (((d)&0xffffffff) >> (32 - (23))));
  (d) += (e);
  (c) += (((d)) ^ ((e)) ^ ((f))) + ((b[(13)])) + (0x289b7ec6);
  (c) = (((c) << (4)) | (((c)&0xffffffff) >> (32 - (4))));
  (c) += (d);
  (f) += (((c)) ^ ((d)) ^ ((e))) + ((b[(0)])) + (0xeaa127fa);
  (f) = (((f) << (11)) | (((f)&0xffffffff) >> (32 - (11))));
  (f) += (c);
  (e) += (((f)) ^ ((c)) ^ ((d))) + ((b[(3)])) + (0xd4ef3085);
  (e) = (((e) << (16)) | (((e)&0xffffffff) >> (32 - (16))));
  (e) += (f);
  (d) += (((e)) ^ ((f)) ^ ((c))) + ((b[(6)])) + (0x04881d05);
  (d) = (((d) << (23)) | (((d)&0xffffffff) >> (32 - (23))));
  (d) += (e);
  (c) += (((d)) ^ ((e)) ^ ((f))) + ((b[(9)])) + (0xd9d4d039);
  (c) = (((c) << (4)) | (((c)&0xffffffff) >> (32 - (4))));
  (c) += (d);
  (f) += (((c)) ^ ((d)) ^ ((e))) + ((b[(12)])) + (0xe6db99e5);
  (f) = (((f) << (11)) | (((f)&0xffffffff) >> (32 - (11))));
  (f) += (c);
  (e) += (((f)) ^ ((c)) ^ ((d))) + ((b[(15)])) + (0x1fa27cf8);
  (e) = (((e) << (16)) | (((e)&0xffffffff) >> (32 - (16))));
  (e) += (f);
  (d) += (((e)) ^ ((f)) ^ ((c))) + ((b[(2)])) + (0xc4ac5665);
  (d) = (((d) << (23)) | (((d)&0xffffffff) >> (32 - (23))));
  (d) += (e);

  (c) += (((e)) ^ (((d)) | ~((f)))) + ((b[(0)])) + (0xf4292244);
  (c) = (((c) << (6)) | (((c)&0xffffffff) >> (32 - (6))));
  (c) += (d);
  (f) += (((d)) ^ (((c)) | ~((e)))) + ((b[(7)])) + (0x432aff97);
  (f) = (((f) << (10)) | (((f)&0xffffffff) >> (32 - (10))));
  (f) += (c);
  (e) += (((c)) ^ (((f)) | ~((d)))) + ((b[(14)])) + (0xab9423a7);
  (e) = (((e) << (15)) | (((e)&0xffffffff) >> (32 - (15))));
  (e) += (f);
  (d) += (((f)) ^ (((e)) | ~((c)))) + ((b[(5)])) + (0xfc93a039);
  (d) = (((d) << (21)) | (((d)&0xffffffff) >> (32 - (21))));
  (d) += (e);
  (c) += (((e)) ^ (((d)) | ~((f)))) + ((b[(12)])) + (0x655b59c3);
  (c) = (((c) << (6)) | (((c)&0xffffffff) >> (32 - (6))));
  (c) += (d);
  (f) += (((d)) ^ (((c)) | ~((e)))) + ((b[(3)])) + (0x8f0ccc92);
  (f) = (((f) << (10)) | (((f)&0xffffffff) >> (32 - (10))));
  (f) += (c);
  (e) += (((c)) ^ (((f)) | ~((d)))) + ((b[(10)])) + (0xffeff47d);
  (e) = (((e) << (15)) | (((e)&0xffffffff) >> (32 - (15))));
  (e) += (f);
  (d) += (((f)) ^ (((e)) | ~((c)))) + ((b[(1)])) + (0x85845dd1);
  (d) = (((d) << (21)) | (((d)&0xffffffff) >> (32 - (21))));
  (d) += (e);
  (c) += (((e)) ^ (((d)) | ~((f)))) + ((b[(8)])) + (0x6fa87e4f);
  (c) = (((c) << (6)) | (((c)&0xffffffff) >> (32 - (6))));
  (c) += (d);
  (f) += (((d)) ^ (((c)) | ~((e)))) + ((b[(15)])) + (0xfe2ce6e0);
  (f) = (((f) << (10)) | (((f)&0xffffffff) >> (32 - (10))));
  (f) += (c);
  (e) += (((c)) ^ (((f)) | ~((d)))) + ((b[(6)])) + (0xa3014314);
  (e) = (((e) << (15)) | (((e)&0xffffffff) >> (32 - (15))));
  (e) += (f);
  (d) += (((f)) ^ (((e)) | ~((c)))) + ((b[(13)])) + (0x4e0811a1);
  (d) = (((d) << (21)) | (((d)&0xffffffff) >> (32 - (21))));
  (d) += (e);
  (c) += (((e)) ^ (((d)) | ~((f)))) + ((b[(4)])) + (0xf7537e82);
  (c) = (((c) << (6)) | (((c)&0xffffffff) >> (32 - (6))));
  (c) += (d);
  (f) += (((d)) ^ (((c)) | ~((e)))) + ((b[(11)])) + (0xbd3af235);
  (f) = (((f) << (10)) | (((f)&0xffffffff) >> (32 - (10))));
  (f) += (c);
  (e) += (((c)) ^ (((f)) | ~((d)))) + ((b[(2)])) + (0x2ad7d2bb);
  (e) = (((e) << (15)) | (((e)&0xffffffff) >> (32 - (15))));
  (e) += (f);
  (d) += (((f)) ^ (((e)) | ~((c)))) + ((b[(9)])) + (0xeb86d391);
  (d) = (((d) << (21)) | (((d)&0xffffffff) >> (32 - (21))));
  (d) += (e);

  a[0] = c + a[0];
  a[1] = d + a[1];
  a[2] = e + a[2];
  a[3] = f + a[3];
}

void B(const char* restrict a, uint b, uint* restrict c) {
  uint d;
  uint e;
  char f[64];

  c[0] = 0x67452301;
  c[1] = 0xefcdab89;
  c[2] = 0x98badcfe;
  c[3] = 0x10325476;

  for (e = b; e >= 64; e -= 64, a = &a[64]) {
    A(c, (const uint*)a);
  }

  for (d = 0; d < e; d++) {
    f[d] = a[d];
  }
  f[e++] = 0x80;

  if (e <= 56) {
    for (d = e; d < 56; f[d++] = 0)
      ;
  } else {
    for (d = e; d < 64; f[d++] = 0)
      ;
    A(c, (uint*)f);
    for (d = 0; d < 56; f[d++] = 0)
      ;
  }

  ulong* g = (ulong*)&f[56];
  *g = b * 8;
  A(c, (uint*)f);
}

void C(const char* restrict a, uint b, uint* restrict c) {
  B(a, b, c);
  c[0] = (((c[0] >> 24) & 0xff) | ((c[0] << 8) & 0xff0000) | ((c[0] >> 8) & 0xff00) | ((c[0] << 24) & 0xff000000));
  c[1] = (((c[1] >> 24) & 0xff) | ((c[1] << 8) & 0xff0000) | ((c[1] >> 8) & 0xff00) | ((c[1] << 24) & 0xff000000));
  c[2] = (((c[2] >> 24) & 0xff) | ((c[2] << 8) & 0xff0000) | ((c[2] >> 8) & 0xff00) | ((c[2] << 24) & 0xff000000));
  c[3] = (((c[3] >> 24) & 0xff) | ((c[3] << 8) & 0xff0000) | ((c[3] >> 8) & 0xff00) | ((c[3] << 24) & 0xff000000));
}